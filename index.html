<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plan de Desarrollo MVP — Diagramas</title>
  <style>
    :root {
      --bg-color: #0d1117;
      --panel-color: #161b22;
      --border-color: #30363d;
      --text-color: #c9d1d9;
      --muted-text-color: #8b949e;
      --accent-color: #58a6ff;
      --danger-color: #f85149;
    }
    html, body {
      height: 100%;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
      background-color: var(--bg-color);
      color: var(--text-color);
      overflow: hidden;
    }
    .deck {
      height: 100vh;
      width: 100vw;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .slide {
      width: 100%;
      height: 100%;
      display: none;
      flex-direction: column;
      padding: 60px 20px 40px 20px;
      box-sizing: border-box;
    }
    .slide.active {
      display: flex;
    }
    .slide-header {
      text-align: center;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
      margin-bottom: 15px;
    }
    .slide-header h2 {
      margin: 0;
      font-size: 22px;
      color: var(--text-color);
    }
    .slide-content {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      border-radius: 8px;
    }
    .slide-content .mermaid, .slide-content svg {
      width: 100%;
      height: 100%;
    }
    .table-container {
      width: 100%;
      height: 100%;
      overflow: auto;
      padding: 10px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      color: var(--text-color);
      background-color: var(--panel-color);
      border-radius: 6px;
      font-size: 14px;
    }
    th, td {
      border: 1px solid var(--border-color);
      padding: 12px 15px;
      text-align: left;
    }
    th {
      background-color: #1f242c;
      font-weight: 600;
    }
    td:first-child {
        font-weight: 500;
    }
    td:not(:first-child) {
        text-align: center;
    }
    .controls, .nav {
      position: absolute;
      top: 15px;
      display: flex;
      gap: 8px;
      z-index: 100;
    }
    .controls { left: 15px; }
    .nav { right: 15px; }
    button {
      background-color: var(--panel-color);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s ease;
    }
    button:hover {
      background-color: #21262d;
      border-color: var(--accent-color);
      color: var(--accent-color);
    }
    button:active {
      transform: scale(0.95);
    }
    .help {
      position: absolute;
      left: 15px;
      bottom: 15px;
      color: var(--muted-text-color);
      font-size: 12px;
      z-index: 100;
    }
    .error-message {
      color: var(--danger-color);
      font-weight: 700;
      text-align: center;
      padding: 20px;
      background-color: rgba(248, 81, 73, 0.1);
      border: 1px solid var(--danger-color);
      border-radius: 6px;
      white-space: pre-wrap;
      font-family: monospace;
    }
  </style>
</head>
<body>

<div class="deck">
  <!-- Controles de navegación y zoom -->
  <div class="controls">
    <button id="prevBtn" title="Diapositiva Anterior (←)">⟨ Anterior</button>
    <button id="nextBtn" title="Siguiente Diapositiva (→)">Siguiente ⟩</button>
  </div>
  <div class="nav">
    <button id="zoomInBtn" title="Acercar (+)">Zoom +</button>
    <button id="zoomOutBtn" title="Alejar (-)">Zoom -</button>
    <button id="fitBtn" title="Ajustar a la pantalla (F)">Ajustar</button>
    <button id="resetBtn" title="Reiniciar vista (0)">Reiniciar</button>
    <button id="fullscreenBtn" title="Pantalla Completa">⛶</button>
  </div>

  <!-- Contenedor de las diapositivas -->
  <div id="slidesContainer" style="width:100%; height:100%;">

    <!-- Diapositiva 1: Roles y permisos (Tabla) -->
    <section class="slide active" data-title="Roles y permisos">
      <div class="slide-header">
        <h2>Roles y permisos (matriz base)</h2>
      </div>
      <div class="slide-content">
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Recurso/Acción</th><th>OWNER</th><th>MANAGER</th><th>CASHIER</th><th>BAKER</th><th>STOREKEEPER</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Tenants/Planes</td><td>✔</td><td>–</td><td>–</td><td>–</td><td>–</td></tr>
              <tr><td>Usuarios/Roles</td><td>✔</td><td>✔</td><td>–</td><td>–</td><td>–</td></tr>
              <tr><td>Catálogo/Precios</td><td>✔</td><td>✔</td><td>(ver)</td><td>–</td><td>(ver)</td></tr>
              <tr><td>Recetas</td><td>✔</td><td>✔</td><td>–</td><td>✔</td><td>–</td></tr>
              <tr><td>Inventario (ajustes)</td><td>✔</td><td>✔</td><td>–</td><td>–</td><td>✔</td></tr>
              <tr><td>Compras/Recepciones</td><td>✔</td><td>✔</td><td>–</td><td>–</td><td>✔</td></tr>
              <tr><td>Producción</td><td>✔</td><td>✔</td><td>–</td><td>✔</td><td>✔</td></tr>
              <tr><td>POS/Ventas</td><td>✔</td><td>✔</td><td>✔</td><td>–</td><td>–</td></tr>
              <tr><td>CPE/GRE</td><td>✔</td><td>✔</td><td>(emitir CPE)</td><td>–</td><td>(emitir GRE)</td></tr>
              <tr><td>Reportes</td><td>✔</td><td>✔</td><td>(ventas)</td><td>(producción)</td><td>(stock)</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Diapositiva 2: Modelo de datos (ERD) -->
    <section class="slide" data-title="Modelo de datos (ERD)">
      <div class="slide-header"><h2>Modelo de datos (ERD)</h2></div>
      <div class="slide-content">
        <div class="mermaid">
erDiagram
    TENANT ||--o{ TENANT_DOMAIN : has
    TENANT ||--o{ USER_MEMBERSHIP : includes
    USER ||--o{ USER_MEMBERSHIP : joins

    TENANT {
      uuid id PK
      text name
      text plan
      text status
      timestamptz created_at
    }
    TENANT_DOMAIN {
      uuid id PK
      uuid tenant_id FK
      text domain
      bool is_primary
    }
    USER {
      uuid id PK
      text email
      text name
      text status
    }
    USER_MEMBERSHIP {
      uuid id PK
      uuid tenant_id FK
      uuid user_id FK
      text role
    }

    CATEGORY ||--o{ PRODUCT : groups
    TENANT ||--o{ CATEGORY : owns
    TENANT ||--o{ PRODUCT : owns
    PRODUCT ||--o{ RECIPE : has
    RECIPE ||--o{ RECIPE_ITEM : composed_of

    CATEGORY {
      uuid id PK
      uuid tenant_id FK
      text name
    }
    PRODUCT {
      uuid id PK
      uuid tenant_id FK
      text sku
      text name
      text type
      text unit
      text tax_code
      bool active
      bool is_batch_tracked
      int shelf_life_days
    }
    RECIPE {
      uuid id PK
      uuid tenant_id FK
      uuid product_id FK
      numeric yield_qty
      text yield_unit
      numeric loss_pct
    }
    RECIPE_ITEM {
      uuid id PK
      uuid tenant_id FK
      uuid recipe_id FK
      uuid ingredient_id FK
      numeric qty
      text unit
      numeric baker_pct
    }

    TENANT ||--o{ WAREHOUSE : has
    PRODUCT ||--o{ STOCK_LEVEL : tracked_in
    PRODUCT ||--o{ STOCK_LOT : batches
    WAREHOUSE ||--o{ STOCK_LEVEL : holds
    WAREHOUSE ||--o{ STOCK_MOVEMENT : records
    STOCK_LOT ||--o{ STOCK_MOVEMENT : referenced_by

    WAREHOUSE {
      uuid id PK
      uuid tenant_id FK
      text name
      text address
      text branch_code
    }
    STOCK_LEVEL {
      uuid id PK
      uuid tenant_id FK
      uuid product_id FK
      uuid warehouse_id FK
      numeric qty_on_hand
      numeric qty_reserved
    }
    STOCK_LOT {
      uuid id PK
      uuid tenant_id FK
      uuid product_id FK
      text lot_code
      date exp_date
      timestamptz created_at
    }
    STOCK_MOVEMENT {
      uuid id PK
      uuid tenant_id FK
      timestamptz ts
      uuid product_id FK
      uuid warehouse_id FK
      uuid lot_id
      numeric qty
      text uom
      text type
      text ref_type
      uuid ref_id
      text note
    }

    SUPPLIER ||--o{ PURCHASE_ORDER : placed
    PURCHASE_ORDER ||--o{ PURCHASE_ITEM : has
    PURCHASE_ORDER ||--o{ GOODS_RECEIPT : results_in
    GOODS_RECEIPT ||--o{ GOODS_RECEIPT_ITEM : contains

    SUPPLIER {
      uuid id PK
      uuid tenant_id FK
      text ruc
      text name
      text contact
      text email
      text phone
    }
    PURCHASE_ORDER {
      uuid id PK
      uuid tenant_id FK
      uuid supplier_id FK
      text status
      timestamptz eta
      numeric total
      text currency
    }
    PURCHASE_ITEM {
      uuid id PK
      uuid tenant_id FK
      uuid purchase_id FK
      uuid product_id FK
      numeric qty
      text unit
      numeric unit_cost
      numeric tax_rate
    }
    GOODS_RECEIPT {
      uuid id PK
      uuid tenant_id FK
      uuid purchase_id FK
      timestamptz received_at
      text doc_ref
    }
    GOODS_RECEIPT_ITEM {
      uuid id PK
      uuid tenant_id FK
      uuid receipt_id FK
      uuid product_id FK
      uuid lot_id FK
      uuid warehouse_id FK
      numeric qty
      text unit
      numeric unit_cost
    }

    POS_REGISTER ||--o{ SALE : processes
    SALE ||--o{ SALE_ITEM : includes
    SALE ||--o{ PAYMENT : gets
    SALE ||--o{ CPE : issues
    GRE ||--o{ STOCK_MOVEMENT : supports

    POS_REGISTER {
      uuid id PK
      uuid tenant_id FK
      text code
      uuid warehouse_id FK
      bool is_open
      timestamptz opened_at
      uuid opened_by
      timestamptz closed_at
      uuid closed_by
      numeric opening_cash
      numeric closing_cash
    }
    SALE {
      uuid id PK
      uuid tenant_id FK
      timestamptz ts
      uuid pos_register_id FK
      uuid customer_id
      text status
      numeric subtotal
      numeric tax
      numeric total
      text currency
      text payment_status
      uuid cpe_id
    }
    SALE_ITEM {
      uuid id PK
      uuid tenant_id FK
      uuid sale_id FK
      uuid product_id FK
      numeric qty
      text unit
      numeric unit_price
      numeric discount_pct
      numeric tax_rate
    }
    PAYMENT {
      uuid id PK
      uuid tenant_id FK
      uuid sale_id FK
      text method
      numeric amount
      text external_txn_id
      text status
      jsonb payload_json
    }
    CPE {
      uuid id PK
      uuid tenant_id FK
      %% FACTURA|BOLETA|NC|ND
      text type
      text series
      text number
      timestamptz issue_ts
      text status
      %% SEE|NUBEFACT|OTRO
      text provider
      text provider_ref
      text pdf_url
      text xml_url
      text cdr_url
      text sunat_ticket
      jsonb response_json
    }
    GRE {
      uuid id PK
      uuid tenant_id FK
      text series
      text number
      timestamptz issue_ts
      text status
      jsonb json_payload
      text sunat_ticket
    }
        </div>
      </div>
    </section>

    <!-- Diapositiva 3: Arquitectura de Sistema -->
    <section class="slide" data-title="Arquitectura - Sistema">
      <div class="slide-header"><h2>Arquitectura — Sistema (Contexto)</h2></div>
      <div class="slide-content">
        <div class="mermaid">
flowchart LR
  actor(Cliente)
  subgraph Browser [Navegador del cliente]
    UI[Next.js App]
  end

  subgraph SaaS [SaaS Panaderías]
    BFF[Gateway / BFF]
    subgraph SVCs [Microservicios FastAPI]
      IDT[identity-tenants]
      CAT[catalog-recipes]
      INV[inventory-procurement]
      POS[sales-pos-fiscal]
    end
    DB[(PostgreSQL/Supabase)]
    OBJ[(Storage S3)]
  end

  subgraph Ext [Servicios externos]
    PAY[Pasarelas: Izipay/Culqi/Niubiz]
    CPE["CPE: SEE / PSE (Nubefact)"]
    SUNAT["SUNAT (validación CPE/GRE)"]
  end

  Cliente-- Usa -->UI
  UI-- REST/JWT -->BFF
  BFF-- REST -->IDT & CAT & INV & POS
  BFF-- set app.tenant_id -->DB
  SVCs-- R/W -->DB
  SVCs-- Presigned URLs -->OBJ
  POS-- Emite -->CPE-- Intercambia -->SUNAT
  UI-- SDK -->PAY
  PAY-- Webhook -->POS
        </div>
      </div>
    </section>

    <!-- Diapositiva 4: Arquitectura de Contenedores -->
    <section class="slide" data-title="Arquitectura - Contenedores">
      <div class="slide-header"><h2>Arquitectura — Contenedores</h2></div>
      <div class="slide-content">
        <div class="mermaid">
flowchart TD
  subgraph Frontend [Frontend - Vercel]
    NJS[Next.js App Router\nNextAuth/Supabase Auth]
  end

  subgraph Backend [Kubernetes/ECS]
    GW["Gateway API (FastAPI)\nSubdominio→tenant_id"]
    IDT[identity-tenants]
    CAT[catalog-recipes]
    INV[inventory-procurement]
    POS[sales-pos-fiscal]
  end

  DB[(PostgreSQL 16 / Supabase)]
  S3[(S3-compatible)]
  PAY[Izipay/Culqi/Niubiz]
  NUBE["Nubefact (PSE) / SEE"]
  SUNAT[SUNAT]

  NJS-->GW
  GW-->IDT
  GW-->CAT
  GW-->INV
  GW-->POS
  IDT & CAT & INV & POS --> DB
  CAT & INV & POS --> S3
  NJS-->PAY
  PAY--webhook-->POS
  POS<-->NUBE
  NUBE<-->SUNAT
        </div>
      </div>
    </section>

    <!-- Diapositiva 5: Secuencia Venta POS -->
    <section class="slide" data-title="Secuencia - Venta POS">
      <div class="slide-header"><h2>Secuencia — Venta POS con pago Yape y CPE</h2></div>
      <div class="slide-content">
        <div class="mermaid">
sequenceDiagram
  participant U as Cajero (POS)
  participant UI as Next.js POS
  participant GW as Gateway API
  participant POSsvc as sales-pos-fiscal
  participant INV as inventory
  participant PAY as Pasarela (Izipay/Culqi/Niubiz)
  participant CPE as CPE (SEE/Nubefact)

  U->>UI: Selecciona ítems / cobra
  UI->>GW: POST /sales (JWT c/tenant_id)
  GW->>POSsvc: Crea venta (PENDING) + reserva stock
  POSsvc->>INV: POST /stock/reserve (items)
  INV-->>POSsvc: OK (reservado)

  UI->>PAY: SDK tokeniza/cobra Yape
  PAY-->>POSsvc: Webhook: pago PAID (firma válida)

  POSsvc->>CPE: POST /cpe (json)
  CPE-->>POSsvc: PDF/XML/CDR + status
  POSsvc->>INV: POST /stock/commit (rebaja real)
  POSsvc-->>GW: Venta CONFIRMED + links CPE
  GW-->>UI: Ticket + enlace CPE
        </div>
      </div>
    </section>

    <!-- Diapositiva 6: Secuencia Orden de Producción -->
    <section class="slide" data-title="Secuencia - Orden de Producción">
        <div class="slide-header"><h2>Secuencia — Orden de Producción</h2></div>
        <div class="slide-content">
            <div class="mermaid">
sequenceDiagram
  participant B as Maestro Panadero
  participant UI as App Producción
  participant GW as Gateway
  participant CAT as catalog-recipes
  participant INV as inventory
  participant PR as production (en INV)

  B->>UI: Define OP (producto terminado, cantidad)
  UI->>GW: POST /production-orders
  GW->>CAT: GET receta + insumos escalados
  GW->>PR: Crear OP (PLANNED)
  PR->>INV: POST /stock/consume (insumos por lote)
  INV-->>PR: Movimientos CONSUME
  PR->>INV: POST /stock/produce (terminados a lote)
  INV-->>PR: Movimientos PRODUCTION_IN
  PR-->>GW: OP FINISHED (rendimiento/merma real)
  GW-->>UI: OP cerrada + stock actualizado
            </div>
        </div>
    </section>

    <!-- Diapositiva 7: Secuencia Recepción de Compra -->
    <section class="slide" data-title="Secuencia - Recepción de Compra">
        <div class="slide-header"><h2>Secuencia — Recepción de Compra con Lotes</h2></div>
        <div class="slide-content">
            <div class="mermaid">
sequenceDiagram
  participant S as Storekeeper
  participant UI as App Compras
  participant GW as Gateway
  participant INV as inventory

  S->>UI: Registrar GR (proveedor, productos)
  UI->>GW: POST /goods-receipts
  GW->>INV: Crear GR + ítems
  INV->>INV: Crear lotes (exp_date) + stock_level
  INV-->>GW: Kardex y saldos actualizados
  GW-->>UI: GR ok + etiquetas de lote
            </div>
        </div>
    </section>

    <!-- Diapositiva 8: Estado Orden de Producción -->
    <section class="slide" data-title="Estado - Orden de Producción">
        <div class="slide-header"><h2>Estado — `production_order`</h2></div>
        <div class="slide-content">
            <div class="mermaid">
stateDiagram-v2
  [*] --> PLANNED
  PLANNED --> IN_PROGRESS: start()
  IN_PROGRESS --> PAUSED: pause()
  PAUSED --> IN_PROGRESS: resume()
  IN_PROGRESS --> FINISHED: complete(rendimiento, merma)
  IN_PROGRESS --> CANCELLED: cancel(motivo)
  PLANNED --> CANCELLED: cancel()
  FINISHED --> [*]
  CANCELLED --> [*]
            </div>
        </div>
    </section>
    
    <!-- Diapositiva 9: Estado Caja POS -->
    <section class="slide" data-title="Estado - Caja POS">
        <div class="slide-header"><h2>Estado — `pos_register` (caja)</h2></div>
        <div class="slide-content">
            <div class="mermaid">
stateDiagram-v2
  [*] --> CLOSED
  CLOSED --> OPEN: open(opening_cash, user)
  OPEN --> OPEN: movements(cash_in/out)
  OPEN --> CLOSED: close(closing_cash, arqueo)
  CLOSED --> [*]
            </div>
        </div>
    </section>

  </div>

  <!-- Ayuda de teclado -->
  <div class="help">← →: Navegar • +/-: Zoom • F: Ajustar • 0: Reiniciar • Arrastrar para mover</div>
</div>

<!-- Librerías desde un CDN fiable (JSDelivr) con versiones fijadas -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Configuración inicial de Mermaid para tema oscuro y renderizado programático
    mermaid.initialize({
        startOnLoad: false,
        securityLevel: 'strict',
        theme: 'base',
        logLevel: 'error',
        themeVariables: {
            background: '#0d1117',
            primaryColor: '#161b22',
            primaryTextColor: '#c9d1d9',
            primaryBorderColor: '#58a6ff',
            lineColor: '#8b949e',
            secondaryColor: '#21262d',
            tertiaryColor: '#161b22',
            noteBkgColor: '#21262d',
            noteTextColor: '#c9d1d9',
            actorBkg: '#21262d',
            actorBorder: '#58a6ff',
            actorTextColor: '#c9d1d9',
            labelColor: '#c9d1d9',
            textColor: '#c9d1d9'
        }
    });

    const slides = Array.from(document.querySelectorAll('.slide'));
    let currentSlideIndex = 0;
    const panZoomInstances = new Array(slides.length).fill(null);

    // Renderiza todos los diagramas Mermaid de forma segura
    async function renderAllMermaids() {
        const mermaidElements = document.querySelectorAll('.mermaid');
        for (const el of mermaidElements) {
            const code = el.textContent.trim();
            el.style.display = 'flex';
            el.style.justifyContent = 'center';
            el.style.alignItems = 'center';
            
            // Si el código está vacío, no hacer nada
            if (!code) continue;

            try {
                // Renderiza el código a SVG
                const { svg } = await mermaid.render(`mermaid-graph-${Math.random().toString(36).substring(2, 9)}`, code);
                el.innerHTML = svg;
            } catch (error) {
                console.error('Error al renderizar Mermaid:', error, 'Código:', code);
                el.innerHTML = `<div class="error-message"><strong>Error al renderizar diagrama:</strong>\n${error.message}</div>`;
            }
        }
    }

    // Inicializa el pan y zoom en una diapositiva
    function initPanZoom(index) {
        if (panZoomInstances[index] || !window.svgPanZoom) return;
        
        const slide = slides[index];
        const svgElement = slide.querySelector('svg');

        if (svgElement) {
            try {
                panZoomInstances[index] = svgPanZoom(svgElement, {
                    zoomEnabled: true,
                    controlIconsEnabled: false,
                    fit: true,
                    center: true,
                    minZoom: 0.1,
                    maxZoom: 20,
                    zoomScaleSensitivity: 0.3,
                    dblClickZoomEnabled: true,
                });
            } catch (e) {
                console.warn('No se pudo inicializar svg-pan-zoom:', e);
            }
        }
    }

    // Muestra una diapositiva específica
    function showSlide(index) {
        if (index < 0 || index >= slides.length) return;

        slides[currentSlideIndex].classList.remove('active');
        currentSlideIndex = index;
        slides[currentSlideIndex].classList.add('active');
        document.title = slides[currentSlideIndex].dataset.title || 'Diagramas';

        initPanZoom(currentSlideIndex);
    }
    
    function handleResize() {
        const instance = panZoomInstances[currentSlideIndex];
        if (instance) {
            instance.resize();
            instance.fit();
            instance.center();
        }
    }

    // --- Asignación de Eventos ---
    document.getElementById('prevBtn').addEventListener('click', () => showSlide(currentSlideIndex - 1));
    document.getElementById('nextBtn').addEventListener('click', () => showSlide(currentSlideIndex + 1));
    document.getElementById('zoomInBtn').addEventListener('click', () => panZoomInstances[currentSlideIndex]?.zoomIn());
    document.getElementById('zoomOutBtn').addEventListener('click', () => panZoomInstances[currentSlideIndex]?.zoomOut());
    document.getElementById('fitBtn').addEventListener('click', () => panZoomInstances[currentSlideIndex]?.fit());
    document.getElementById('resetBtn').addEventListener('click', () => panZoomInstances[currentSlideIndex]?.reset());
    
    const fullscreenBtn = document.getElementById('fullscreenBtn');
    fullscreenBtn.addEventListener('click', () => {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch(err => {
                alert(`Error al activar pantalla completa: ${err.message}`);
            });
        } else {
            document.exitFullscreen();
        }
    });

    window.addEventListener('keydown', (e) => {
        const instance = panZoomInstances[currentSlideIndex];
        switch (e.key) {
            case 'ArrowRight': showSlide(currentSlideIndex + 1); break;
            case 'ArrowLeft': showSlide(currentSlideIndex - 1); break;
            case '+': case '=': if(instance) instance.zoomIn(); break;
            case '-': case '_': if(instance) instance.zoomOut(); break;
            case 'f': case 'F': if(instance) { instance.fit(); instance.center(); } break;
            case '0': if(instance) instance.reset(); break;
        }
    });

    window.addEventListener('resize', handleResize);
    
    // Iniciar todo el proceso
    renderAllMermaids().then(() => {
        showSlide(0);
    }).catch(err => {
        console.error("Fallo crítico en el proceso de renderizado:", err);
    });
});
</script>
</body>
</html>